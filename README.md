# Film recommendation system containerized using Docker and deployed in Google Kubernetes Engine

> **Film recommendation system that scrapes IMDb data, provides realâ€‘time suggestions through a Streamlit web UI, and ships in a Docker image ready for GoogleÂ KubernetesÂ Engine (GKE) deployment.**

## ğŸ“¸ Demo

This is a screenshot of actual use of an app, showing the 5 most similar films to the chosen film:

---

<div align="center">
  <img src="docs/screenshot.png" alt="Streamlit app screenshot" width="700"/>
</div>

---

## TableÂ ofÂ Contents

1. [Projectâ€¯Overview](#project-overview)
2. [Keyâ€¯Features](#key-features)
3. [Architecture](#architecture)
4. [QuickÂ Start](#quick-start)

   - [LocallyÂ withÂ Python](#locally-with-python)
   - [DockerÂ Container](#docker-container)
   - [KubernetesÂ (GKE)](#kubernetes-gke)

5. [ProjectÂ Structure](#project-structure)
6. [HowÂ itÂ Works](#how-it-works)

   - [1Â Â·Â DataÂ Scraping](#1--data-scraping)
   - [2Â Â·Â FeatureÂ EngineeringÂ &Â VectorÂ Store](#2--feature-engineering--vector-store)
   - [3Â Â·Â RecommendationÂ Engine](#3--recommendation-engine)
   - [4Â Â·Â StreamlitÂ Frontend](#4--streamlit-frontend)

7. [ConfigurationÂ &Â EnvironmentÂ Variables](#configuration--environment-variables)
8. [Testing](#testing)
9. [Contributing](#contributing)
10. [Roadmap](#roadmap)
11. [License](#license)
12. [Acknowledgements](#acknowledgements)

---

## Project Overview

This repository contains an **endâ€‘toâ€‘end contentâ€‘based recommender** that suggests movies similar to a userâ€‘selected title. It automatically **scrapes metadata from IMDb**, computes textual embeddings, and serves fast similarity lookâ€‘ups through a **Streamlit GUI**. The whole stack is containerised with **Docker** and the manifests provided let you deploy effortlessly to **GoogleÂ KubernetesÂ Engine**. ([github.com](https://github.com/bpogorelc/e2e-content-based-recommendation-system))

---

## Key Features

| Â CategoryÂ         | Â HighlightsÂ                                                                                            |
| ----------------- | ------------------------------------------------------------------------------------------------------ |
| Â **Data**Â         | IMDb scraper written in Python (`scraping.py`) Â· Oneâ€‘command refresh of `imdb_data.xlsx`               |
| Â **MLÂ Pipeline**Â  | TFâ€‘IDF + cosine similarity (lightweight & fast) Â· Preâ€‘computed matrices serialised to `similarity.pkl` |
| Â **App**Â          | Reactive Streamlit interface with searchâ€‘asâ€‘youâ€‘type and poster thumbnails                             |
| Â **Ops**Â          | `Dockerfile` for reproducible builds Â· `deployment.yaml` & `service.yaml` for GKE                      |
| Â **CI**Â           | Optional GitHubÂ Actions template (`.github/workflows/ci.yml`) for lintÂ +Â pytest                        |

---

## Architecture

```mermaid
flowchart TB
  subgraph Pipeline
    A["Scrape IMDb"] --> B["Clean & Feature-Engineer"]
    B --> C["Vectorise (TF-IDF)"]
    C --> D["Similarity Matrix"]
    D --> E["Persist *.pkl"]
  end

  subgraph Serving
    F["Streamlit UI"] --> G["Recommendation API"]
    G --> D
  end

  subgraph Deployment
    H["Docker Image"] -->|kubectl apply| I["GKE Cluster"]
    I --> F
  end
```

---

## QuickÂ Start

### Locally with Python

```bash
# 1Â Â·Â Clone & enter the repo
$ git clone https://github.com/bpogorelc/e2e-content-based-recommendation-system.git
$ cd e2e-content-based-recommendation-system

# 2Â Â·Â Create a virtual environment (PythonÂ >=Â 3.10)
$ python3 -m venv .venv
$ source .venv/bin/activate

# 3Â Â·Â Install dependencies
$ pip install -r requirements.txt

# 4Â Â·Â (Optional) Refresh the dataset
$ python scraping.py  # fetches latest IMDb top movies & overwrites imdb_data.xlsx
$ python recommendation_engine.py  # recreates movie_list.pkl & similarity.pkl

# 5Â Â·Â Launch the app
$ streamlit run app.py
```

Then open [http://localhost:8501](http://localhost:8501) in your browser.

### Docker Container

```bash
# Build the image
$ docker build -t movie-recommender:latest .

# Run locally
$ docker run -p 8501:8501 movie-recommender:latest
```

### KubernetesÂ (GKE)

1. Push the image to a registry (`gcr.io`, `ghcr.io`, etc.).
2. Update `deployment.yaml` image reference.
3. Deploy:

   ```bash
   $ kubectl apply -f deployment.yaml -f service.yaml
   ```

4. Grab the external IP and navigate to `http://EXTERNAL_IP:80`.

> **Tip:** The provided manifests request only 1Â CPU / 512Â Mi memoryâ€”perfect for the free tierÂ cluster.

---

## Project Structure

```
.
â”œâ”€â”€ app.py                  # Streamlit entryâ€‘point
â”œâ”€â”€ scraping.py             # IMDb webâ€‘scraper
â”œâ”€â”€ recommendation_engine.py# Builds similarity matrix & pickles
â”œâ”€â”€ imdb_data.xlsx          # Cached raw data (regenerated by scraper)
â”œâ”€â”€ movie_list.pkl          # Preâ€‘processed list of movie metadata
â”œâ”€â”€ similarity.pkl          # square cosineâ€‘similarity matrix
â”œâ”€â”€ Dockerfile
â”œâ”€â”€ deployment.yaml
â”œâ”€â”€ service.yaml
â”œâ”€â”€ requirements.txt
â””â”€â”€ README.md  â† you are here
```

---

## How it Works

### 1 Â· Data Scraping

`scraping.py` uses **BeautifulSoup** to crawl selected IMDb lists (default: _TopÂ 1â€¯000 Movies_). It resolves:

- Title, year, runtime, certificate, genres, director, stars
- Short plot outline
- Poster URL

The output is cached to `imdb_data.xlsx` to avoid hammering IMDb on every run.

### 2 Â· Feature Engineering & Vector Store

Key textual fields are concatenated into a single _bagâ€‘ofâ€‘words_. A **TFâ€‘IDF Vectorizer** (from `scikitâ€‘learn`) transforms these bags into highâ€‘dimensional vectors. The resulting sparse matrix is saved to disk.

### 3 Â· Recommendation Engine

To fetch _N_ similar movies we:

1. LookÂ up the vector row for the target movie.
2. Compute cosine similarity scores to every other row.
3. Return the topâ€‘N indices.

Preâ€‘computing the full `similarity.pkl` enables instant (<Â 5â€¯ms) responses at runâ€‘time.

### 4 Â· Streamlit Frontend

The UI offers an autoâ€‘complete select box,â€”after choosing a title the five most similar movies (plus posters & IMDb links) are displayed.

---

## Configuration & Environment Variables

| Variable              | Default            | Description                         |
| --------------------- | ------------------ | ----------------------------------- |
| `IMDB_SOURCE_URL`     | IMDb TopÂ 1000 list | Override to scrape a different list |
| `NUM_RECOMMENDATIONS` | `5`                | How many similar movies to show     |
| `PORT`                | `8501`             | Port Streamlit listens on           |

All variables can be supplied via `.env` or Kubernetes ConfigMap.

---

## Testing

```bash
$ pip install -r requirements-dev.txt  # includes pytest, black, flake8
$ pytest -q
```

> **CI hint:** See `.github/workflows/ci.yml` for an example GitHubÂ Actions pipeline (lint â†’ unitÂ tests â†’ Docker buildÂ &Â push).

---

## Contributing

1. Fork the project and create your feature branch (`git checkout -b feature/awesome`)
2. Commit your changes with clear messages
3. Push to the branch (`git push origin feature/awesome`)
4. Open a PullÂ Request

Please run **`black`** and **`flake8`** before committing.

---

## Roadmap

- [ ] Swap TFâ€‘IDF for transformerâ€‘based sentence embeddings (e.g. `sentenceâ€‘transformers`)
- [ ] Add _"Similar becauseâ€¦"_ explanation using featureÂ weights
- [ ] Multiâ€‘select input to create _taste profiles_
- [ ] Optional PostgreSQL + pgvector backend
- [ ] HelmÂ chart for oneâ€‘command GKE deployment

---

## License

Distributed under the MIT License. See [`LICENSE`](LICENSE) for details.

---

## Acknowledgements

- IMDb for the underlying movie metadata
- [Streamlit](https://streamlit.io) for the ridiculously quick webÂ apps
- [`scikitâ€‘learn`](https://scikit-learn.org) for the TFâ€‘IDF & cosine utilities

<p align="center">
  <em>HappyÂ movieÂ hunting!Â ğŸ¿</em>
</p>
